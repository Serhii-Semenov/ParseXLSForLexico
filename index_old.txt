<?php
/**
 * Created by PhpStorm.
 * User: Base
 * Date: 14.07.2017
 * Time: 14:06
 */

include_once ('PHPExcel-1.8/Classes/PHPExcel.php');

spl_autoload_register(function ($class) {
    include_once 'logic/classes/' . $class . '.php';
});

//$a = new Basis("0.12121");
//echo $a->sku4noGe."<br>";
//$a->sku4noGe = "No";
//echo $a->sku4noGe."<br>";
//$b = floatval ((string)($a->Descr)); //str_replace('.',',', $a->Descr);
//echo ($b)."<br>";

$a = " July      05, 2017";
$d = new Date($a);
echo $d->DateStr.' ~ <br>';
echo $d->Date.' ~ <br>';

//$StartDate = StartDateOfAction::getInstance();
//var_dump($StartDate->Change);
echo '<hr>';
var_dump((StartDateOfAction::getInstance()->Change));

echo '<hr>';
//$c = explode(" ", trim(preg_replace('/\s+/',' ', $d->Date)));
//echo $d->Date.'     ';
//echo $c[0].'  ~  ';
//echo  $d::MONTH[$c[0]]." --- ";

//foreach ($d::MONTH as $key => $value)
//    echo "$key = $value .. ";

//foreach ($c as $str)
//    echo $str.'~';



echo '<hr><br>';
$excel = (new PHPExcel_Reader_Excel5())->load('data/iBasisLight.xls', ReadDataOnly);
foreach ($excel->getWorksheetIterator() as $worksheet){
    $lists[] = $worksheet->toArray();
//    echo $worksheet->getTitle().'<br>';
//    foreach ($lists as $list){
//        if ($worksheet->getTitle() == 'Rate Mod Sheet') var_dump($list);
//        echo '<hr>';
//    }
}



//$WorksheetExcel = new WorksheetExcel();
//foreach ($excel->getWorksheetIterator() as $worksheet){
//    $lists[] = $worksheet->toArray();
//    foreach ($lists as $list){
//        switch($worksheet->getTitle()){
//            case $WorksheetExcel->PatternNameWorksheets[0][0]:{
//                if ($WorksheetExcel->PatternNameWorksheets[0][1] == false) {
//                    $WorksheetExcel->PatternNameWorksheets[0][2] = $worksheet->toArray();
//                }
//            }
//        }
//
//
//    }
//}
//var_dump($WorksheetExcel->PatternNameWorksheets[0][2]);



//$t = array( 0 =>
//    array( 0 => 'first_name', 1 => 'last_name', 2 => 'position', 3 => 'office')
//);
//$t += [1 => [ 0 => 'sdafasd', 1=>'dfsaas', 2 => 'dcvcxvx', 3 => 'sdfsdfsd12ww' ]];
//$t += [2 => [ 0 => 'Ivas', 1 => 'Valist', 2 => 'poc', 3 => 'setts' ]];
//var_dump($t);
//echo "```   ";
//echo '$t[2][1]'." = {$t[2][1]}".'<br>   ';
//var_dump($StartDate::SYMBOLS);


//$sada = new Basis();

//
foreach ($lists as $list){
     echo '<table border="1">';
     foreach ($list as $row){
         echo '<tr>';
         foreach ($row as $col){
             echo '<td>'.$col.'</td>';
         }
         echo '</tr>';
     }
     echo '</table>';
     echo '<br><hr><br>';
 }






//$cells = $pe->getActiveSheet()->getMergeCells(); //activeSheet()->cellsAsArray();

//$objReader = new PHPExcel_Reader_Excel5();
//$objReader->setReadDataOnly(true);
//$objPHPExcel = $objReader->load('data/iBasisLight.xls');
//
//$pe = $objPHPExcel->getSheetByName("Pending Rate List");
//
////echo 'Memory usage: ', showMemUsage();
//
////$objPHPExcel->disconnectWorksheets();
////unset($objPHPExcel);
//
//
//
////unset($reader);
//
//echo "<pre>";
////print_r(array([0, 1], [1,1]));
//print_r($cells);
//echo "</pre>";
